<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="SangK的个人博客"><title>JS仿《阿丽塔》中依德医生的旋转缩放控件 — DEMO篇 | SangK的博客</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">JS仿《阿丽塔》中依德医生的旋转缩放控件 — DEMO篇</h1><a id="logo" href="/.">SangK的博客</a><p class="description">勿忘初心</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" autocomplete="off" results="0"><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/编程/">编程</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/随笔/">随笔</a><span class="category-list-count">3</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/心情/" style="font-size: 15px;">心情</a> <a href="/tags/前端/" style="font-size: 15px;">前端</a> <a href="/tags/JavaScript/" style="font-size: 15px;">JavaScript</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/03/23/雨/">雨</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/31/JS仿《阿丽塔》中依德医生的旋转缩放控件/">JS仿《阿丽塔》中依德医生的旋转缩放控件 — DEMO篇</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/20/梦/">梦</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/01/博客开张/">博客开张</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://dongpobaicai.github.io/" title="东坡白菜的前端之路" target="_blank">东坡白菜的前端之路</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">JS仿《阿丽塔》中依德医生的旋转缩放控件 — DEMO篇</h1><div class="post-meta">Mar 31, 2019<span> | </span><span class="category"><a href="/categories/编程/">编程</a></span></div><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_site_pv" style="display:none"><span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#正文"><span class="toc-number">2.</span> <span class="toc-text">正文</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-画圆环"><span class="toc-number">2.1.</span> <span class="toc-text">1. 画圆环</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-监听鼠标事件"><span class="toc-number">2.2.</span> <span class="toc-text">2. 监听鼠标事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-实时计算当前角度"><span class="toc-number">2.3.</span> <span class="toc-text">3. 实时计算当前角度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-根据角度计算方向和距离，旋转圆环"><span class="toc-number">2.4.</span> <span class="toc-text">4. 根据角度计算方向和距离，旋转圆环</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-操作外部dom"><span class="toc-number">2.5.</span> <span class="toc-text">5. 操作外部dom</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#后记"><span class="toc-number">3.</span> <span class="toc-text">后记</span></a></li></ol></div></div><div class="post-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前些天看了《阿丽塔》<br>感叹酷炫特效的同时，不得不说这个片子灰常之热血！<br>重新点燃了我粪斗的基情！！<br>有那么几个瞬间仿佛自己回到了……</p>
<p><img src="https://pic-1257007754.cos.ap-chengdu.myqcloud.com/meme/停一下.jpg" width="30%" alt="https://sangk.site"></p>
<p>OK，下面进入正题<br>在依德医生刚捡回阿丽塔的那一段，有木有发现医生家的设备都很有意思～<br>比如那个人皮缝纫机，其灵活程度堪比织网ing的蜘蛛<br>说到蜘蛛，就想起了西游记里的蜘蛛精……</p>
<p><img src="https://pic-1257007754.cos.ap-chengdu.myqcloud.com/meme/QNMD.jpg" width="30%" alt="https://sangk.site"></p>
<p>…………<br>…………<br>除了人皮缝纫机，当时还注意到他们屏幕的一个交互很有趣——</p>
<p><img src="https://pic-1257007754.cos.ap-chengdu.myqcloud.com/alita/alita-screen.gif" width="77%" alt="https://sangk.site"></p>
<p>没错，今天的主角出场了<br>就是用JS做一个类似的旋转缩放控件<br>先来看一哈最终效果，铛铛：</p>
<p><img src="https://pic-1257007754.cos.ap-chengdu.myqcloud.com/alita/alita-6.gif" width="100%" alt="https://sangk.site"></p>
<p>貌似手感不错？可以<a href="https://sangk57.github.io/alitalia-rotate-zoom/" target="_blank">点此抢先体验</a></p>
<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>本篇首先开发一个demo试试水，暂时用鼠标代替手指</p>
<p><strong>实现思路如下：</strong></p>
<ol>
<li>画一个彩色圆环</li>
<li>监听鼠标移动事件（保证只能作用在圆环上）</li>
<li>实时计算鼠标当前的角度（相对于圆心）</li>
<li>对比当前角度和上一次角度，确定每一帧的旋转方向和距离</li>
<li>根据实时变化的角度值旋转圆环，同时操作外部dom</li>
</ol>
<h3 id="1-画圆环"><a href="#1-画圆环" class="headerlink" title="1. 画圆环"></a>1. 画圆环</h3><p>这里使用<strong>大圆套小圆</strong>组成圆环：大圆设置一个渐变背景色，小圆为纯白色<br>为啥子不只用一个圆，然后设置border属性捏？<br><del>因为我不喜欢</del><br>因为border不能设置渐变色【滑稽】<br>当然还有另一个作用：阻止事件（详见下文）</p>
<p>万事俱备，开始装逼<br>目标是把圆环用绝对定位放到左上角，而且内圆要适中大小<br>所以分别设置圆心和大小圆的半径为：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> CENTER = &#123; <span class="attr">x</span>: <span class="number">150</span>, <span class="attr">y</span>: <span class="number">150</span> &#125;, BIG_RADIUS = <span class="number">150</span>, SMALL_RADIUS = <span class="number">70</span></span><br></pre></td></tr></table></figure></p>
<p>创建div表示两个圆<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bigCircle = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>)</span><br><span class="line"><span class="keyword">var</span> smallCircle = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>)</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(bigCircle)</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(smallCircle)</span><br></pre></td></tr></table></figure></p>
<p>封装一个函数方便给大小圆添加样式<br>参数：<code>center</code>圆心、<code>radius</code>半径、<code>bg</code>背景、<code>isMove</code>是否运动（使用CSS3的变化和旋转，每0.16秒运动一次，即60帧）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setCircleClass</span>(<span class="params">center, radius, bg, isMove</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.style.position = <span class="string">'absolute'</span></span><br><span class="line">    <span class="keyword">this</span>.style.left = center.x - radius + <span class="string">'px'</span></span><br><span class="line">    <span class="keyword">this</span>.style.top = center.y - radius + <span class="string">'px'</span></span><br><span class="line">    <span class="keyword">this</span>.style.width = radius * <span class="number">2</span> + <span class="string">'px'</span></span><br><span class="line">    <span class="keyword">this</span>.style.height = radius * <span class="number">2</span> + <span class="string">'px'</span></span><br><span class="line">    <span class="keyword">this</span>.style.borderRadius = <span class="string">'50%'</span></span><br><span class="line">    <span class="keyword">this</span>.style.zIndex = <span class="number">66666</span></span><br><span class="line">    <span class="keyword">this</span>.style.background = bg</span><br><span class="line">    isMove &amp;&amp; (<span class="keyword">this</span>.style.transition = <span class="string">'transform linear .016s'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>调用函数添加样式<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setCircleClass.apply(bigCircle, [CENTER, BIG_RADIUS, <span class="string">'linear-gradient(skyblue, darkorange)'</span>, <span class="literal">true</span>])</span><br><span class="line">setCircleClass.apply(smallCircle, [CENTER, SMALL_RADIUS, <span class="string">'#FFF'</span>, <span class="literal">false</span>])</span><br></pre></td></tr></table></figure></p>
<p>颜色有点瓜皮：<br><img src="    https://pic-1257007754.cos.ap-chengdu.myqcloud.com/alita/alita-1.jpg" width="30%" alt="https://sangk.site"></p>
<h3 id="2-监听鼠标事件"><a href="#2-监听鼠标事件" class="headerlink" title="2. 监听鼠标事件"></a>2. 监听鼠标事件</h3><p>监听大圆的<code>mousemove</code>事件，同时小圆阻止事件传播<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bigCircle.addEventListener(<span class="string">'mousemove'</span>, main)</span><br><span class="line">smallCircle.addEventListener(<span class="string">'mousemove'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    e.stopPropagation()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>创建大圆的监听函数<code>main</code><br>这里设置鼠标左键按下时生效，顺便写一个打印语句<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(e.buttons === <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'鼠标在圆环移动ing'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="    https://pic-1257007754.cos.ap-chengdu.myqcloud.com/alita/alita-2.gif" width="70%" alt="https://sangk.site"></p>
<h3 id="3-实时计算当前角度"><a href="#3-实时计算当前角度" class="headerlink" title="3. 实时计算当前角度"></a>3. 实时计算当前角度</h3><p>接下来就是重头戏了，想要让圆环跟随鼠标转动，首先想到的绝壁是<strong>斜率</strong><br>在监听事件触发时，不停计算鼠标位置和圆心两点连线的斜率，通过对比本次的斜率和上一次斜率，即可得出圆环转动的方向<br>方向有了，还要计算圆环移动的速度，然而斜率的变化并不是线性的，因此很难通过斜率的变化值来计算速度……<br>所以光有斜率是没办法解决问题的，那么有木有其他线性变化的东西呢<img src="https://pic-1257007754.file.myqcloud.com/alu/托腮.png" style="height: 2rem;"><br>没错，就是角度了～！</p>
<p>记得Math对象有一些三角函数方法，速速去查</p>
<p>正在眼花缭乱之时，突然眼角一闪，一个黑衣人从天而降，定睛一看，正是传说中的<strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/atan2" target="_blank">atan2函数</a></strong><br>“骚年，你要找的人正是在下”</p>
<p>打量了一番，发现这哥们不仅长得帅，而且手中还拿了一个神器：计算角度函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">calcAngleDegrees</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.atan2(y, x) * <span class="number">180</span> / <span class="built_in">Math</span>.PI</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://pic-1257007754.file.myqcloud.com/alu/喜极而泣.png" style="height: 2rem;">卧槽，简直是踏破铁鞋，赶紧来战：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(e.buttons === <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> angle = calcAngleDegrees((e.clientX - CENTER.x), (CENTER.y - e.clientY))</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'角度：'</span> + angle)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="    https://pic-1257007754.cos.ap-chengdu.myqcloud.com/alita/alita-3.gif" width="70%" alt="https://sangk.site"><br>如图可以看到，角度的变化是从9点钟方向的180度，顺时针递减360度，回到9点钟方向<br>正符合我们后续的需求</p>
<p><img src="https://pic-1257007754.cos.ap-chengdu.myqcloud.com/meme/妙呀.jpg" width="30%" alt="https://sangk.site"></p>
<p>“大师果然牛皮，不知您的一身好武功是如何修来的？”<br>atan2笑而不语，一转身便消失在了无尽的夜色中，只留下了无尽的疑问……</p>
<p>既然如此，作为一个热爱技术的搬砖工，我决定自己找出真相<img src="https://pic-1257007754.file.myqcloud.com/alu/推眼镜.png" style="height: 2rem;"></p>
<p><img src="https://pic-1257007754.cos.ap-chengdu.myqcloud.com/meme/能用就行了.jpg" width="40%" alt="https://sangk.site"><br>本小节终。</p>
<h3 id="4-根据角度计算方向和距离，旋转圆环"><a href="#4-根据角度计算方向和距离，旋转圆环" class="headerlink" title="4. 根据角度计算方向和距离，旋转圆环"></a>4. 根据角度计算方向和距离，旋转圆环</h3><p>有了角度值，下面就的问题就引刃而解了</p>
<p>先创建一个函数用来旋转圆环，参数：<code>deg</code>当前圆环的角度<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">rotate</span>(<span class="params">deg</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.style.webkitTransform = <span class="string">'rotate('</span> + deg + <span class="string">'deg)'</span></span><br><span class="line">    <span class="keyword">this</span>.style.mozTransform = <span class="string">'rotate('</span> + deg + <span class="string">'deg)'</span></span><br><span class="line">    <span class="keyword">this</span>.style.msTransform = <span class="string">'rotate('</span> + deg + <span class="string">'deg)'</span></span><br><span class="line">    <span class="keyword">this</span>.style.oTransform = <span class="string">'rotate('</span> + deg + <span class="string">'deg)'</span></span><br><span class="line">    <span class="keyword">this</span>.style.transform = <span class="string">'rotate('</span> + deg + <span class="string">'deg)'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>创建变量：当前圆环(大圆)角度值<code>circleAngle</code>、当前鼠标角度值<code>mouseAngle</code>、上一次鼠标角度值<code>lastMouseAngle</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> circleAngle = <span class="number">0</span>, mouseAngle, lastMouseAngle</span><br></pre></td></tr></table></figure></p>
<p>此处需初始化<code>lastMouseAngle</code>，这个操作看似简单，实则使用正确的姿势可以<strong>避免一系列bug</strong><br>这里研究出来比较好的方法就是在<em>鼠标移入圆环</em>和<em>在圆环中按下鼠标</em>的时候赋值，感性趣的童鞋可以自行研究一下<img src="https://pic-1257007754.file.myqcloud.com/alu/长草.png" style="height: 2rem;"><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">bigCircle.addEventListener(<span class="string">'mouseenter'</span>, init)</span><br><span class="line">bigCircle.addEventListener(<span class="string">'mousedown'</span>, init)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    lastMouseAngle = calcAngleDegrees((e.clientX - CENTER.x), (CENTER.y - e.clientY))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>初始化<code>lastMouseAngle</code>之后，<code>mouseAngle - lastMouseAngle</code>即为角度的增量</p>
<p>增量正负决定方向：<em>正数为逆时针，负数为顺时针</em><br>增量大小决定距离：<em>绝对值即是圆环旋转的角度</em></p>
<p>由于顺时针旋转时增量为负，且CSS里<code>transform</code>属性为顺时针旋转增加角度<br>所以当前圆环的角度计算公式为：<code>circleAngle -= (mouseAngle - lastMouseAngle)</code></p>
<p>改造<code>main</code>函数：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(e.buttons === <span class="number">1</span>) &#123;</span><br><span class="line">        mouseAngle = calcAngleDegrees((e.clientX - CENTER.x), (CENTER.y - e.clientY))</span><br><span class="line">        <span class="keyword">var</span> changeMouseAngle = mouseAngle - lastMouseAngle</span><br><span class="line">        circleAngle -= changeMouseAngle</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'当前角度：'</span> + circleAngle)</span><br><span class="line">        rotate.call(<span class="keyword">this</span>, circleAngle)</span><br><span class="line">        lastMouseAngle = mouseAngle</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="https://pic-1257007754.cos.ap-chengdu.myqcloud.com/alita/alita-4.gif" width="70%" alt="https://sangk.site"><br>可以看到已经有了雏形，愉快地进入下一步</p>
<h3 id="5-操作外部dom"><a href="#5-操作外部dom" class="headerlink" title="5. 操作外部dom"></a>5. 操作外部dom</h3><p>想要操作外部dom，需要的是一个<em>线性变化</em>的值<br>用脚趾头都能想到，当前最合适的无疑就是当前圆环角度<code>circleAngle</code>了<br>然鹅仔细观察上一张图就会发现，当鼠标每次移动过9点钟方向时，圆环角度就会瞬间改变360度，回到初始值，并不能满足当前需求<img src="https://pic-1257007754.file.myqcloud.com/alu/思考.png" style="height: 2rem;"><br>此处做一波改造，判断当角度的变化值<code>changeMouseAngle</code>超过一定度数的时候，不执行后面的操作<br>考虑到用户的手速，暂时设置这个值为300<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> MAX_CHANGE_ANGLE = <span class="number">300</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">var</span> changeMouseAngle = mouseAngle - lastMouseAngle</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">Math</span>.abs(changeMouseAngle) &gt; MAX_CHANGE_ANGLE)&#123;</span><br><span class="line">        <span class="keyword">return</span> lastMouseAngle = mouseAngle</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这样<code>circleAngle</code>就会呈线性变化了</p>
<p><img src="https://pic-1257007754.cos.ap-chengdu.myqcloud.com/alita/alita-5.gif" width="70%" alt="https://sangk.site"></p>
<p>接下来的事就是找一张阿丽塔的美图了<img src="https://pic-1257007754.file.myqcloud.com/xh/胖.gif" style="height: 2rem;"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"pic"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"./alita.jpg"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.pic</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">100px</span> auto;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.pic</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>随便写一段缩放代码：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> picDom = <span class="built_in">document</span>.getElementsByClassName(<span class="string">'pic'</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">controlPic</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.style.width = <span class="number">100</span> + <span class="number">1</span> * value + <span class="string">'px'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    controlPic.call(picDom, circleAngle)</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>大功告成！查看完整的代码示例请<a href="https://github.com/sangk57/alitalia-rotate-zoom/blob/master/demo/demo.html" target="_blank">戳这里</a>，在线体验请<a href="https://sangk.site/alitalia-rotate-zoom/" target="_blank">戳这里</a> <img src="https://pic-1257007754.file.myqcloud.com/alu/坐等.png" style="height: 2rem;"></p>
<h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>从《阿丽塔》上映那天起就开始酝酿这篇博客了，直到一个多月后的今天……</p>
<p>不多BB，下一篇博客将会在demo的基础上封装为插件，有生之年见<img src="https://pic-1257007754.file.myqcloud.com/alu/献花.png" style="height: 2rem;"></p>
<p><img src="https://pic-1257007754.cos.ap-chengdu.myqcloud.com/meme/装X结束.jpg" width="40%" alt="https://sangk.site"></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a class="article-share-link" data-url="https://sangk57.github.io/2019/03/31/JS仿《阿丽塔》中依德医生的旋转缩放控件/" data-id="ckmlehgyt0002zwna184qe21v" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAADIElEQVR42u3azW4qMQwGUN7/pbnbStWln+0gzXhOVojCJCcsXP+8XvF6/1jJO7/Xz8983iV5J3/maGFjY2PfhD057udjJdc0ed27emxsbOyt7M+kXtjoXWJ06OKpsLGxsbHfxRVtXAQkl4iNjY2N/ZmdH/pUwejUObGxsbGfwE6KSnm4ytOSz+Bkx6/X0rCxsbEvz84Pff3XX+lvY2NjY1+Y/R6syfZJy/aLJ8fGxsZexO6NyPQKSb2SUDUpKjSnsbGxsVew80JP9ZN5gzYJivPhodfkuNjY2NgXZucjNXkykCcbSTjMg1MeDrGxsbE3sfM0oLpxr6zf45V/DGxsbOyl7ElRqVpgKsTVYiiNLhobGxt7EbsaunrtgbyJW73cUfsZGxsbewU7Tyd6F1SlTpKfwvmxsbGxF7HPph/VcNIrY/WeiY2Njf00drVxm4zRVAdxelfTzMCwsbGxb87Ow9i8MJS3aU+1n/84OTY2NvYidvKh6gZ5SKv+DNWBS2xsbOyt7GoAmBx00jCYXNMoxmJjY2Pfil3+971IrZb+kyZ0r0WBjY2NvYldHXypJip5OyFJdXrN4EJ7ABsbG/u27FNpRjU9qO6YDw9Fu2BjY2MvYlcfnYSWV7x6PY3qJWJjY2M/gZ0HpN5fe/3nHJwnJ9jY2Nib2PNhxx6v1x44VZbCxsbG3sQ+FYR6pZ/eqFBeSPpiqwAbGxv7Muw8zJxKTnrjO4dTFGxsbOxF7PxByUHzFGVy6MO1NGxsbOybs0+NwlSbtXnYS75b/cGwsbGxN7HngPxb87GeyagQNjY29lZ2tdU6CTbztkFSbIquDBsbG3sRO39EfinVYNZLb3rBL+pXY2NjY9+K/S6uvKzTS0tOBVFsbGzs57Dn0a86gpOHxl6T+HAIxMbGxr4Juxq08pA2CTzVAlP+HGxsbOyt7HwoJ6HmQaU6glMNuv99BxsbG/uR7AlmPtBTDZl/PBkbGxv7kexekagXuvISUn7Fo1QEGxsb+/LsatkobxXnVzwZuyw3nrGxsbEXsasFmuTo+QbzC8rLXs3+NjY2NvZ12f8Alwm1qa9qg+QAAAAASUVORK5CYII=">分享</a><div class="tags"><a href="/tags/前端/">前端</a><a href="/tags/JavaScript/">JavaScript</a></div><div class="post-nav"><a class="pre" href="/2021/03/23/雨/">雨</a><a class="next" href="/2019/01/20/梦/">梦</a></div><div id="vcomment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script type="text/javascript" src="/js/Valine.min.js"></script><script>var notify = 'false' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  av: AV,
  el:'#vcomment',
  notify:notify,
  verify:verify,
  emoticon_url: 'https://pic-1257007754.cos.ap-chengdu.myqcloud.com',
  emoticon: [{
      name: '阿鲁',
      cover: "alu/开心.png",
      icon: [ "alu/开心.png",
              "alu/无语.png",
              "alu/暗地观察.png", 
              "alu/白旗.png", 
              "alu/鄙视.png",
              "alu/闭嘴.png",
              "alu/便便.png", 
              "alu/抽烟.png",
              "alu/瞅.png",
              "alu/呲牙.png",
              "alu/大款.png",
              "alu/得意.png",
              "alu/愤怒.png",
              "alu/尴尬.png",
              "alu/鼓掌.png",
              "alu/观察.png",
              "alu/害羞.png",
              "alu/汗.png",
              "alu/狂汗.png",
              "alu/欢呼.png",
              "alu/击掌.png",
              "alu/惊喜.png",
              "alu/抠鼻.png",
              "alu/口水.png",
              "alu/哭.png",
              "alu/黑线.png",
              "alu/蜡烛.png",
              "alu/脸红.png",
              "alu/难过.png",
              "alu/内伤.png",
              "alu/喷血.png",
              "alu/喷水.png",
              "alu/期待.png",
              "alu/亲亲.png",
              "alu/扇耳光.png",
              "alu/深思.png",
              "alu/思考.png",
              "alu/锁眉.png",
              "alu/摊手.png",
              "alu/吐.png",
              "alu/吐舌.png",
              "alu/吐血倒地.png",
              "alu/推眼镜.png",
              "alu/托腮.png",
              "alu/捂脸.png",
              "alu/捂眼.png",
              "alu/喜极而泣.png",
              "alu/献花.png",
              "alu/献黄瓜.png",
              "alu/小眼睛.png",
              "alu/邪恶.png",
              "alu/咽气.png",
              "alu/赞.png",
              "alu/阴暗.png",
              "alu/长草.png",
              "alu/中刀.png",
              "alu/中枪.png",
              "alu/肿包.png",
              "alu/皱眉.png",
              "alu/坐等.png"
            ],
  }, {
      name: '小黄鸡',
      cover: "xh/斜眼.jpg",
      icon: [ "xh/盯.png",
              "xh/斜眼.jpg",
              "xh/吃米花.gif",
              "xh/晕.jpg",
              "xh/吃瓜.jpg",
              "xh/威胁.jpg",
              "xh/瞪.jpg",
              "xh/猫.jpg",
              "xh/耳机.gif",
              "xh/墨镜.jpg",
              "xh/喝饮料.gif",
              "xh/荷叶.gif",
              "xh/气球.gif",
              "xh/生气.jpg",
              "xh/睡觉.jpg",
              "xh/偷看.jpg",
              "xh/紧张.jpg",
              "xh/汗.png",
              "xh/黑线.jpg",
              "xh/喝果汁.jpg",
              "xh/巴掌.jpg",
              "xh/平底锅.jpg",
              "xh/吃惊.jpg",
              "xh/震惊.jpg",
              "xh/WTF.jpg",
              "xh/刀.jpg",
              "xh/嗨皮.gif",
              "xh/略略略.jpg",
              "xh/头发呢.jpg",
              "xh/哭泣.jpg",
              "xh/流泪.jpg",
              "xh/无聊.gif",
              "xh/无语.jpg",
              "xh/小眼睛.jpg",
              "xh/邪恶.jpg",
              "xh/胖.gif",
              "xh/瞅.jpg",
              "xh/吃手.jpg",
              "xh/问号.jpg",
              "xh/心态崩了.jpg"
            ],
  }],
  appId:'iqNG9hiPGXEGgKgum6XBB5iI-gzGzoHsz',
  appKey:'APo648zutswBiqacaL7xeUHE',
  placeholder:'人走可以，评论留下~',
  //- avatar:'mp',
  //- guest_info:guest_info,
  pageSize:'15'
})</script></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2021 <a href="/." rel="nofollow">SangK的博客.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>